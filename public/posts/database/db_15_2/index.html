<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Jay Log | Data Type in DB</title>
    <meta name="description" content="Enum to Hyper type ">
    <link rel="canonical" href="http://jaym-oh.github.io/posts/database/db_15_2/" />
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <meta property="og:title" content="Data Type in DB" />
<meta property="og:description" content="Enum to Hyper type" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://jaym-oh.github.io/posts/database/db_15_2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-03-29T09:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-29T00:00:00+00:00" />



    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Data Type in DB"/>
<meta name="twitter:description" content="Enum to Hyper type"/>

    
        
    

    
    <link rel="stylesheet" href='/css/style.css' />
    
    <link rel="stylesheet" href='/css/search.css' />
    
    <link rel="stylesheet" href='/css/md_nb.css' />
    <link rel="stylesheet" href='/css/list.css' />
    <link rel="stylesheet" href='/css/terms.css' />
    <link rel="stylesheet" href='/css/taxonomy.css' />
    
    <link rel="stylesheet" href='/css/font-awesome-4.7.0/css/font-awesome.min.css' />
    <link rel="stylesheet" href='/css/home.css' />
    
    <link rel="stylesheet" href='/css/syntax.css' />
    
        <link rel="stylesheet" href='/css/comment.css' />
    
    <link rel="stylesheet" href='/css/shortcode.css' />
    
    
    
    <link rel="stylesheet" href='/css/custom.css' />
    <style>
         
    </style>
    
    
        <script src='//cdnjs.cloudflare.com/ajax/libs/valine/1.5.0/Valine.min.js'></script>
    
    
    
    <script src="/js/lazysizes.min.js" async=""></script>
    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/search.js"></script>
    <script src="/js/md_nb.js"></script>
    <script src="/js/yes.js"></script>
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
</head><body style="font-family: ,'Helvetica Neue', Helvetica, Arial, 'PingFang SC', 'Hiragino Sans GB', 'Heiti SC', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif;">
        <div class="loading">
            <div class="loading-bg"></div>
            <div class="loading-long">
                <div class="loading-short"></div>
            </div>
        </div>

        <header>
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="/">
                <span class="logo">Jay Log</span>
            </a>
        </div>
        <div class="navbar-menu">
            
                <a href="/">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-home'></i> Home</div>
                        </div>
                    </div>
                </a>
            
                <a href="/posts">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-book'></i> Posts</div>
                        </div>
                    </div>
                </a>
            
                <a href="/categories">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-folder-open'></i> Categories</div>
                        </div>
                    </div>
                </a>
            
                <a href="/series">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-gears'></i> Series</div>
                        </div>
                    </div>
                </a>
            
                <a href="/tags">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-tags'></i> Tags</div>
                        </div>
                    </div>
                </a>
            
                <a href="/about">
                    <div class="menu-item">
                        <div class="hengtiao-root">
                            <div class="hengtiao"></div>
                            <div class="name text-wbd-reverse"><i class='fa fa-info-circle'></i> About</div>
                        </div>
                    </div>
                </a>
            
            <div class="navbar-burger">
                <div class="burger-btn"><span><i class="fa fa-navicon"></i></span></div>
            </div>
            
            
            <div class="search-in"><span><i class="fa fa-search"></i></span></div>
            
                <div class="mode">
                    <span class="sun"><i class="fa fa-sun-o"></i></span>
                    <span class="moon"><i class="fa fa-moon-o"></i></span>
                </div>
            
        </div>
    </nav>
    <div class="burger-items">
        
        <a href="/">
            <div class="burger-item">
                <i class='fa fa-home'></i> Home
            </div>
        </a>
        
        <a href="/posts">
            <div class="burger-item">
                <i class='fa fa-book'></i> Posts
            </div>
        </a>
        
        <a href="/categories">
            <div class="burger-item">
                <i class='fa fa-folder-open'></i> Categories
            </div>
        </a>
        
        <a href="/series">
            <div class="burger-item">
                <i class='fa fa-gears'></i> Series
            </div>
        </a>
        
        <a href="/tags">
            <div class="burger-item">
                <i class='fa fa-tags'></i> Tags
            </div>
        </a>
        
        <a href="/about">
            <div class="burger-item">
                <i class='fa fa-info-circle'></i> About
            </div>
        </a>
        
    </div>
    <div class="header-rest"></div>
</header>


        <div id="content">








    <div class="hero">
        
            <div class="hero-img">
                <img class="lazyload" src="/images/thumbnail.gif" data-src="/images/defualt.jpg" alt="">
            </div>
        
        <div class="hero-content">
            <div class="hero-title">Data Type in DB</div>
            <div class="hero-subtitle"></div>
            <div class="hero-date">
                    <span class="no-wrap"><i class="fa fa-calendar"></i> postedOn: 2024-3-29 &nbsp;</span>
                    <span class="no-wrap"><i class="fa fa-calendar-check-o"></i> updatedOn: 2024-3-29 &nbsp;</span>
                    <span class="no-wrap"><i class="fa fa-folder"></i>
                        includedIn:
                        
                            <a href='
                                /categories/database
                            '>
                                Database
                            </a>
                    </span>    
            </div>
            <div class="timelong">
                <span class="no-wrap"><i class="fa fa-pencil"></i> wordsCount: 3641 &nbsp;</span>
                <span class="no-wrap"><i class="fa fa-clock-o"></i> readingTime: 8 mins &nbsp;</span>
                <span class="no-wrap"><i class="fa fa-eye"></i> viewers: <span id="busuanzi_value_page_pv"></span></span>
            </div>
        </div>
    </div>




<div class="zhuti-0">
    <div class="container">
        <div class="zhuti">
            <div class="zhuti-l">
                




    


<div class="content-root">
    <div class="long">
        <button class="tosides-1 text-wbd">
            <i class="fa fa-arrow-right"></i>
        </button>
        <button class="tosides-2 text-wbd">
            <i class="fa fa-arrow-left"></i>
        </button>
        <button class="toup text-wbd">
            <i class="fa fa-arrow-up"></i>
        </button>
    </div>
    
        <div class="content">
            <div class="content-self">
                <h2 id="enum">ENUM</h2>
<ul>
<li>테이블의 구조에 나열된 목록 중 하나의 값을 가질 수 있다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_enum</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">fd_enum</span><span class="w"> </span><span class="n">enum</span><span class="p">(</span><span class="s1">&#39;PROCESSING&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FAILURE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SUCCESS&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- 매핑된 문자열이 아닌 내부적으로 저장된 숫자 값으로 연산이 실행됨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">fd_enum</span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">fd_enum_real_value</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_enum</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>enum 타입은 쿼리에서 char, varchar 타입과 같은 문자열로 비교하거나 저장할 수 있다.</li>
<li>enum 타입에 사용할 수 있는 최대 아이템 갯수는 65535개
<ul>
<li>아이템 갯수가 255개 미만이면 1바이트를 사용</li>
</ul>
</li>
<li>장점
<ul>
<li>테이블 구조에 정의된 코드 값만 사용할 수 있게 강제한다.</li>
<li>DB 서버의 디스크 저장 공간의 크기를 줄여줌
<ul>
<li>레코드가 많아질수록 효율적</li>
</ul>
</li>
</ul>
</li>
<li>단점
<ul>
<li>
<p>enum 타입에 새로운 값을 추가한다면 테이블의 구조를 변경해야 한다.</p>
<ul>
<li>MySQL 5.6 이전까지는 항상 테이블을 리빌드해야 했음 -&gt; 별로 사용하지 않음</li>
<li>MySQL 5.6 부터는 새로 추가하는 아이템이 enum 타입의 제일 마지막에 추가되는 형태하면 텡블의 구조 변경만으로 즉시 완료된다.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_enum</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">modify</span><span class="w"> </span><span class="n">fd_enum</span><span class="w"> </span><span class="n">enum</span><span class="p">(</span><span class="s1">&#39;PROCESSING&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FAILURE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SUCCESS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;REFUND&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">algorithm</span><span class="o">=</span><span class="n">instant</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_enum</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">modify</span><span class="w"> </span><span class="n">fd_enum</span><span class="w"> </span><span class="n">enum</span><span class="p">(</span><span class="s1">&#39;PROCESSING&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FAILURE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;REFUND&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SUCCESS&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">algorithm</span><span class="o">=</span><span class="k">copy</span><span class="p">,</span><span class="w"> </span><span class="k">lock</span><span class="o">=</span><span class="n">shared</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>테이블이 매우 크다면 가독성이 조금 떨어지더라도 새로운 아이템을 enum 마지막에 추가하는 것이 MySQL 서버의 가용성을 높이는 방법</li>
</ul>
</li>
</ul>
</li>
<li>enum 타입 값으로 정렬하면 매핑된 코드 값으로 정렬이 수행됨
<ul>
<li>enum은 문자열이 아닌 정수 타입의 컬럼</li>
<li>되도록이면 enum 기준으로 정렬은 안하는게 좋음</li>
</ul>
</li>
</ul>
<h2 id="set">SET</h2>
<ul>
<li>enum과의 차이: set은 하나의 컬럼에 1개 이상의 값을 저장할 수 있다.
<ul>
<li>MySQL 서버는 내부적으로 BIT-OR 연산을 거쳐서 1개 이상의 선택된 값을 저장한다.</li>
<li>여러 개의 값을 저장할 수 있지만 그만큼의 공간을 가지지는 않음</li>
</ul>
</li>
<li>아이템 수가 8개 이하면 1바이트의 저장공간을 가짐</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_set</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">fd_set</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="s1">&#39;TENNIS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SOCCER&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GOLF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TABLE-TENNIS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BASKETBALL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BILLIARD&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">tb_set</span><span class="w"> </span><span class="p">(</span><span class="n">fd_set</span><span class="p">)</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;SOCCER&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;GOLF,TENNIS&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_set</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">find_in_set</span><span class="p">(</span><span class="s1">&#39;GOLF&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">fd_set</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">tb_set</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">fd_set</span><span class="o">=</span><span class="s1">&#39;GOLF,TENNIS&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>find_in_set 함수나 like로 검색할 수 있음
<ul>
<li>find_in_set 함수는 해당 컬럼에 인덱스가 있어도 효율적으로 인덱스를 이용할 수 없다.</li>
<li>이런 형태의 검색이 빈번히 사용된다면 set 타입의 컬럼을 정규화해서 별도로 인덱스를 가진 자식 테이블을 생성하는 것이 좋다.</li>
</ul>
</li>
<li>equals 비교 시에는 컬럼에 저장된 순서대로 문자열을 나열해야 검색 가능</li>
<li>중간에 아이템이 추가된다면 테이블의 읽기 잠금과 리빌드 작업이 필요
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">alter</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_set</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">modify</span><span class="w"> </span><span class="n">fd_set</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="s1">&#39;TENNIS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SOCCER&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GOLF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TABLE-TENNIS&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Football&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BASKETBALL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BILLIARD&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">algorithm</span><span class="o">=</span><span class="k">copy</span><span class="p">,</span><span class="w"> </span><span class="k">lock</span><span class="o">=</span><span class="n">shared</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>아이템 갯수가 8 -&gt; 9개로 변경될 때는 set 타입을 저장하기 위한 공간을 2바이트로 변경해야하기 때문에 읽기 잠금과 테이블 리빌드 작업이 필요하다.</li>
</ul>
</li>
</ul>
<h1 id="text와-blob">TEXT와 BLOB</h1>
<table>
<thead>
<tr>
<th>데이터 타입</th>
<th>필요 저장 공간 (L = 저장하고자 하는 데이터의 바이트 수)</th>
<th>저장 가능한 최대 바이트 수</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYTEXT, TINYBLOB</td>
<td>L + 1바이트</td>
<td>$2^8-1(255)$</td>
</tr>
<tr>
<td>TEXT, BLOB</td>
<td>L + 2바이트</td>
<td>$2^{16} - 1(65535)$</td>
</tr>
<tr>
<td>MEDIUMTEXT, MEDIUMBLOB</td>
<td>L + 3바이트</td>
<td>$2^{24}-1(16777215)$</td>
</tr>
<tr>
<td>LONGTEXT, LONGBLOB</td>
<td>L + 4바이트</td>
<td>$2^{32}-1(4294967295)$</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>고정길이</th>
<th>가변길이</th>
<th>대용량</th>
</tr>
</thead>
<tbody>
<tr>
<td>문자 데이터</td>
<td>CHAR</td>
<td>VARCHAR</td>
<td>TEXT</td>
</tr>
<tr>
<td>이진 데이터</td>
<td>BINARY</td>
<td>VARBINARY</td>
<td>BLOB</td>
</tr>
</tbody>
</table>
<ul>
<li>TEXT, BLOB 타입 모두 주의하고 남용하면 안됨
<ul>
<li>컬럼 하나에 저장되는 문자열이나 이진 값의 길이가 예측할 수 없이 클 때</li>
<li>일반적으로 하나의 레코드는 전체 크기가 64KB를 넘을 수 없지만 이를 초과할 때</li>
</ul>
</li>
<li>blob/text 컬럼을 조작하는 sql문의 길이가 많이 길어질 수 있음
<ul>
<li>max_allowed_packet 시스템 변수에 설정된 값보다 큰 sql 문장은 MySQL 서버로 전송되지 못하고 오류가 발생할 수 있음</li>
<li>max_allowed_packet 값을 충분히 늘리도록 설정</li>
</ul>
</li>
<li>MySQL 서버에서 text, blob 컬럼의 값이 어떻게 저장되는지는 테이블의 row_format 옵션을 사용한다.
<ul>
<li>별도로 지정되지 않으면 innodb_default_for_format 시스템 변수에 저장된 값으로 적용한다.</li>
<li>MySQL 8.0에서는 사용 가능한 모든 row_format에서는 가능하다면 text/blob 컬럼의 값을 다른 레코드와 같이 저장하려고 하지만 레코드의 최대 길이가 제한적인 문제가 있음
<ul>
<li>레코드의 최대 길이를 초과하면 용량이 큰 컬럼 순서대로 외부 페이지로 옮기면서 레코드의 크기를 맞춘다.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="공간-데이터-타입">공간 데이터 타입</h1>
<ul>
<li>MySQL 서버는 OpenGIS에서 제시하는 표준을 준수함
<ul>
<li>WKT (Well Known Text) or WKB (Well Known Binary)를 이용해서 공간 데이터를 관리할 수 있게 지원</li>
<li>MySQL에서 제공하는 공간 정보 저장용 데이터 타입: POINT, LINESTRING, POLYGON, GEOMETRY, GEOMETRYCOLLECTION 등</li>
</ul>
</li>
<li>geometry로 하나의 점/선/다각형을 저장하거나 geometrycollection으로 여러개의 데이터를 저장할 수 있음</li>
</ul>
<h2 id="공간-데이터-생성">공간 데이터 생성</h2>
<ul>
<li>MySQL 서버에서 공간 데이터를 생성할 때는 WKT 포맷을 이진 데이터 포맷의 데이터로 변환할 수 있음
<ul>
<li>WKT 포맷: POINT(x y)</li>
<li>객체 생성: ST_PointFromText(&lsquo;POINT(x y)&rsquo;)
<ul>
<li>FromText 대신 FromWKB를 사용하면 WKB를 이용한 공간 데이터 객체를 생성한다.</li>
</ul>
</li>
</ul>
</li>
<li>두번째 파라미터로 SRID를 설정 가능
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="n">ST_PointFromText</span><span class="p">(</span><span class="s1">&#39;POINT(10,20)&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">ST_PointFromText</span><span class="p">(</span><span class="s1">&#39;POINT(37.123123, 127.233243)&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">ST_PointFromText</span><span class="p">(</span><span class="s1">&#39;POINT(10,20)&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">ST_PointFromText</span><span class="p">(</span><span class="s1">&#39;POINT(37.123123, 127.233243)&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4326</span><span class="p">)</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>SRID를 명시하지 않으면 <code>SRID=0</code>인 객체를 생성한다.</li>
</ul>
</li>
</ul>
<h2 id="공간-데이터-조회">공간 데이터 조회</h2>
<ul>
<li>MySQL 서버가 관리하는 공간 데이터를 조회하는 방법
<ul>
<li>이진 데이털 조회 (WKB 포맷 or MySQL 이진 포맷)</li>
<li>텍스트 데이터 조회 (WKT 포맷)</li>
<li>공간 데이터의 속성 함수를 이용한 조회</li>
<li>1, 2번째는 공간 데이터 타입과 관계없이 ST_AsText() / ST_AsWKT() or ST_AsBinary() / ST_AsWKB() 함수로 조회 가능</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">set</span><span class="w"> </span><span class="o">@</span><span class="n">poi</span><span class="p">:</span><span class="o">=</span><span class="n">ST_PointFromText</span><span class="p">(</span><span class="s1">&#39;POINT(37.123123 127.123123)&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4326</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">select</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ST_SRID</span><span class="p">(</span><span class="o">@</span><span class="n">poi</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">srid</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ST_X</span><span class="p">(</span><span class="o">@</span><span class="n">poi</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">coord_x</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ST_Y</span><span class="p">(</span><span class="o">@</span><span class="n">poi</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">coord_y</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ST_Latitude</span><span class="p">(</span><span class="o">@</span><span class="n">poi</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">coord_latitude</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ST_Longitude</span><span class="p">(</span><span class="o">@</span><span class="n">poi</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">coord_longitude</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- ST_Latitude ST_Longitude는 위도/경도를 사용하는 좌표시스템의 공간 데이터에서만 사용 가능
</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="json-타입">JSON 타입</h1>
<ul>
<li>MySQL 5.7 부터 JSON 데이터를 저장할 수 있는 JSON 타입이 지원되기 시작</li>
<li>MySQL 8.0 부터 많은 기능과 성능이 개선됨</li>
<li>MySQL 서버에서 TEXT, BLOB 컬럼에 JSON 데이터를 저장할 수는 있음</li>
<li>MySQL 5.7부터 지원되는 JSON 데이터 컬럼은 문자열 저장이 아닌 MongoDB와 같이 바이너리 포맷의 BSON(Binary JSON)으로 변환해서 저장한다.</li>
</ul>
<h2 id="저장-방식">저장 방식</h2>
<ul>
<li>BSON 타입으로 변환해서 저장하기 때문에 TEXT/BLOB보다 공간 효율이 높은 편</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_json</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="n">json</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">tb_json</span><span class="w"> </span><span class="k">values</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;{&#34;user_id&#34;: 123}&#39;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;{&#34;user_id&#34;: &#34;123&#34;}&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">json_type</span><span class="p">(</span><span class="n">fd</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s2">&#34;$.user_id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">field_type</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">json_storage_size</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">byte_size</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">tb_json</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>json document가 MySQL 서버의 JSON 컬럼에 저장되면 이진 데이터로 변환하여 저장한다.</li>
<li>용량이 매우 큰 document가 저장되면 MySQL 서버는 16KB 단위로 여러 개의 데이터 페이지로 나뉘어 저장한더.
<ul>
<li>MySQL 5.7 까지는 BLOB 페이지들이 단순 연결 리스트처럼 관리되었음</li>
<li>MySQL 8.0 부터는 BLOB 페이지들의 인덱스를 관리하고, 각 인덱스는 실제 BLOB 데이터를 가진 페이지들의 링크를 갖도록 개선함</li>
</ul>
</li>
</ul>
<h2 id="부분-업데이트-성능">부분 업데이트 성능</h2>
<ul>
<li>MySQL 8.0 부터 JSON 타입에 대해 부분 업데이트 기능 제공</li>
<li>JSON_SET() JSON_REPLACE() JSON_REMOVE() 함수를 이용해서 JSON document의 특정 필드 값을 변경하거나 삭제하는 경우에만 작동</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="k">update</span><span class="w"> </span><span class="n">tb_json</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">set</span><span class="w"> </span><span class="n">fd</span><span class="o">=</span><span class="n">json_set</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;$.user_id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;12345&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">select</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">json_storage_size</span><span class="p">(</span><span class="n">fd</span><span class="p">),</span><span class="w"> </span><span class="n">json_storage_free</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">from</span><span class="w"> </span><span class="n">tb_json</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>id</th>
<th>fd</th>
<th>json_storage_size(fd)</th>
<th>json_storage_free(fd)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>{&ldquo;user_id&rdquo;, 1234567890}</td>
<td>23</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>{&ldquo;user_id&rdquo;, &ldquo;12345&rdquo;}</td>
<td>30</td>
<td>5</td>
</tr>
</tbody>
</table>
<ul>
<li>위 변경 작업이 <code>부분 업데이트</code>로 처리되었는지는 확인할 수 없음
<ul>
<li><code>json_storage_size</code>, <code>json_storage_free</code> 함수로 대략 예측</li>
<li>두번째 레코드는 json_storage_free가 5로 표시됨
<ul>
<li>&ldquo;12345&quot;로 변경되면서 앞 부분의 5바이트 사용, 5바이트는 비움</li>
</ul>
</li>
<li>해당 필드의 값을 10바이트보다 큰 값으로 저장할 경우
<ul>
<li>json_set() 함수를 사용해도 부분 업데이트 진행 x</li>
<li>최초 할당된 공간이 부족해서 MySQL 서버가 JSON 컬럼 or 두번째 레코드를 다른 위치로 복사해서 저장</li>
</ul>
</li>
</ul>
</li>
<li>MySQL 내부적으로 json 컬럼의 값은 BLOB 타입으로 저장되는데 실제 json 컬럼의 값은 4GB까지 값을 가질 수 있음
<ul>
<li>1MB json 데이터를 저장해도 MySQL 서버는 16KB * 64개 페이지를 사용함
<ul>
<li>부분 업데이트를 한다면 1개의 페이지만 변경하면 되고, 안되면 모든 페이지를 다시 디스크로 기록해야함</li>
</ul>
</li>
</ul>
</li>
<li>단순 정수필드의 값을 변경하는 작업은 항상 부분 업데이트 기능이 적용</li>
<li>문자열 타입의 필드라면 문자열의 길이에 따라 부분 업데이트가 되지 않을수도 있음
<ul>
<li>자주 길이가 변한다면 해당 필드가 가질 수 있는 최대 길이로 초기화하거나 애플리케이션에서 추가로 패딩해서 고정 길이의 문자열로 만들어서 저장하는 방법이 있음</li>
</ul>
</li>
</ul>
<h2 id="json-타입-콜레이션과-비교">JSON 타입 콜레이션과 비교</h2>
<ul>
<li>json 컬럼에 저장되는 데이터와 이를 가공해서 나온 결과는 모두 utf8mb4 문자 집합과 utf8mb4_bin 콜레이션을 가진다.
<ul>
<li>utf8mb4_bin 콜레이션은 바이너리 콜레이션이므로 json을 가공해서 나온 문자열은 대소문자나 액센트 문자도 구분해서 비교한다.</li>
</ul>
</li>
</ul>
<h2 id="json-컬럼-선택">JSON 컬럼 선택</h2>
<ul>
<li>TEXT/BLOB vs JSON
<ul>
<li>TEXT/BLOB에 json 문자열을 저장하는 경우 아무런 변환과정을 거치지 않고 값을 디스크에 저장한다.</li>
<li>JSON 타입은 json 데이터를 이진 포맷으로 컴팩션해서 저장하고, 필요한경우 부분 업데이트를 통한 빠른 변경 기능을 제공한다.</li>
<li>A무조건 json 타입 사용이 좋음</li>
</ul>
</li>
<li>정규화한 컬럼 vs json 컬럼
<ul>
<li>json 컬럼만 유지하는 경우에도 필요한 인덱스를 모두 생성할 수 있음</li>
<li>MySQL 8.0부터 멀티 밸류 인덱스 기능이 지원되기 때문에 json document에서 array 타입의 필드에도 인덱스를 생성할 수 있게됨</li>
<li>성능을 중심으로 판단한다면 정규화된 컬럼을 추천</li>
<li>테이블을 너무 정규화했을때 테이블 갯수가 많아지더간 응용 프로그램의 코드도 길어질 수 있음
<ul>
<li>중요도가 낮다면 json 컬럼 사용도 가능</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="가상-컬럼-파생-컬럼">가상 컬럼 (파생 컬럼)</h1>
<ul>
<li>MySQL 서버의 가상 컬럼은 <code>가상 컬럼</code>/<code>스토어드 컬럼</code>으로 구분</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- 가상 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_virual_column</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">price</span><span class="w"> </span><span class="nb">decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;0.00&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">quantity</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">total_price</span><span class="w"> </span><span class="nb">decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span><span class="n">quantity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="n">virtual</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- 스토어드 컬럼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">tb_stored_column</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">price</span><span class="w"> </span><span class="nb">decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;0.00&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">quantity</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">total_price</span><span class="w"> </span><span class="nb">decimal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span><span class="n">quantity</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">price</span><span class="p">)</span><span class="w"> </span><span class="n">stored</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>컬럼의 정의 뒤에 as절로 계산식을 정의한다.
<ul>
<li>마지막에 <code>stored</code> 키워드가 사용되면 스토어드 컬럼으로 생성되며, 그 외에는 가상 컬럼으로 생성된다. (default는 virtual)</li>
</ul>
</li>
<li>가상 컬럼의 표현식은 입력이 동일하면 시점과 관계없이 결과가 항상 동일한 표현식만 사용할 수 있음
<ul>
<li>사용자 변수나 not-deterministic 옵션의 함수나 표현식 사용할 수 없음</li>
<li>MySQL 8.0 까지는 가상 컬럼의 표현식에 서브쿼리나 스토어드 프로그램을 사용할 수 없음</li>
</ul>
</li>
<li>가상/스토어드 컬럼 모두 다른 컬럼의 값을 참조해서 새로운 값을 만들어 관리한다는 공통점이 있음
<ul>
<li>단점
<ul>
<li>가상 컬럼
<ul>
<li>컬럼의 값이 디스크에 저장되지 않음</li>
<li>컬럼의 구조 변경은 테이블 리빌드를 필요로 하지 않음</li>
<li>컬럼의 값은 레코드가 읽히기 전 또는 before 트리거 실행 직후에 계산되어 만들어짐</li>
</ul>
</li>
<li>스토어드 컬럼
<ul>
<li>컬럼의 값이 물리적으로 디스크에 저장됨</li>
<li>컬럼의 구조 변경은 다른 일반 테이블과 같이 필요 시 테이블 리빌드 방식으로 처리됨</li>
<li>insert, update 시점에만 컬럼의 값이 계산됨</li>
</ul>
</li>
</ul>
</li>
<li>차이
<ul>
<li>계산된 컬럼의 값이 디스크에 실제 저장되는지 여부
<ul>
<li>가상 컬럼은 디스크에 저장되지 않지만 항상 그런건 아님</li>
</ul>
</li>
</ul>
</li>
<li>가상 컬럼은 데이터를 조회하는 시점에 매번 계산되기 때문에 가상 컬럼의 값을 계산하는 과정이 복잡하고 시간이 오래걸린다면 스토어드 컬럼으로 변경하는 것이 성능 향상에 좋음</li>
</ul>
</li>
</ul>

            </div>
            
                <div class="tags">
                    
                    <span class="down-type-item">
                        <div class="type-text">
                            <a href='
                                        /tags/db
                                    '>
                                <i class="fa fa-tag"></i> DB
                            </a>
                        </div>
                    </span>
                    
                </div>
            
        </div>
        
            
                <div class="pre-next">
                    
    
        
        <a href="http://jaym-oh.github.io/posts/docker/docker_1/" class="pre">
            <span class="pre-icon"><i class="fa fa-hand-o-left"></i></span>
            <div class="pre-title-root">
                <span>Before you begin</span>
            </div>
        </a>
        

        
        <a href="http://jaym-oh.github.io/posts/algorithm/sorting/sorting_1/" class="next">
            <div class="next-title-root">
                <span>How to Sort Data</span>
            </div>
            <span class="next-icon"><i class="fa fa-hand-o-right"></i></span>
        </a>
        

    
    

                </div>
            
        
    
</div>

    
        <div class="content-last">
            
                <button class="aixin content-last-item efct-button">
                    <i class="fa fa-heart"></i>
                </button>
            
            
                <button class="pinglun content-last-item efct-button">
                    <i class="fa fa-comment"></i>
                </button>
            
        </div>
    


            </div>
            <div class="zhuti-r">
                
<div class="zhuti-r-0">
    <div class="zhuti-r-1">
        
            <div class="button-r">
                <button class="button-mulu efct-button" type="button"><span><i class="fa fa-bars"></i></span><span class="bars-text"> content</span></button>
                <button class="button-comment efct-button" type="button"><span><i class="fa fa-comment"></i></span><span class="comment-text"> comment</span></button>
            </div>
        
        <div id="r1">
            

<div class="about-zuozhe">
    <div class="zuozhe">
        
            <div class="datou">
                <img class="lazyload" src="/images/thumbnail.gif" data-src="/images/jay1.jpeg" alt="">
            </div>
        
        <div class="name-jianjie">
            <div class="name">JAY OH</div>
            <div class="jianjie">
                고려대코딩개발협동조합 창단 멤버
            </div>
        </div>
    </div>

    <div class="type">
        <a href='
                    /posts/
                '>
            <p>posts</p>
            <p>5</p>
        </a>
        <a href='
                    /categories/
                '>
            <p>categories</p>
            <p>4</p>
        </a>
        <a href='
                    /tags/
                '>
            <p>tags</p>
            <p>9</p>
        </a>
    </div>

    <a href="https://github.com/JayM-Oh">
        <div class="follow">Follow Me</div>
    </a>
    <div class="link">
        
        <a href="https://github.com/JayM-Oh" class="link-item is-hidden-desktop" title="GitHub">
            <span class="icon"><i class='fa fa-github'></i></span>
        </a>
        
        <a href="https://www.youtube.com" class="link-item is-hidden-desktop" title="YouTube">
            <span class="icon"><i class='fa fa-youtube'></i></span>
        </a>
        
    </div>
</div>
            <div class="mulu">
    <div class="dong"></div>
    <div class="zhi">
        <div class="wenzi">
            <div class="zhi-mulu text-wbd">Table of Contents</div>
            <div class="mulu-items">
            </div>
        </div>
    </div>
</div>
            



    
    


<div class="other">
    <div class="other-up">
        <div class="other-qita text-wbd">Related Posts</div>
        <div class="xian"></div>
    </div>
    <div class="list">
        
            <a href="http://jaym-oh.github.io/posts/algorithm/sorting/sorting_2/">
                
<a href="http://jaym-oh.github.io/posts/algorithm/sorting/sorting_2/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/default.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Sorting Problem
            </div>
            <div class="other-summary">Problem Jay likes sequences, so he use to playing with a sequence of size N. He will transform the sequence according to K queries, and the format and process of the queries are as follows:
L R X: Let&rsquo;s say the sequence sorted in ascending order is A[1], A[2], …, A[N].</div>
            <div class="other-date">2024-3-29</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="http://jaym-oh.github.io/posts/algorithm/sorting/sorting_1/">
                
<a href="http://jaym-oh.github.io/posts/algorithm/sorting/sorting_1/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/default.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                How to Sort Data
            </div>
            <div class="other-summary">Introduction What this post focus on This posting will cover almost every concept of How to sort (primary). Plus, I&rsquo;ll post realistic algorithm problem of our real world so that you can apply those concept to real world problem and learn how to use it. I really hope so. Let&rsquo;s see the below example.</div>
            <div class="other-date">2024-3-29</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="http://jaym-oh.github.io/posts/docker/docker_1/">
                
<a href="http://jaym-oh.github.io/posts/docker/docker_1/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/docker.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                Before you begin
            </div>
            <div class="other-summary"><p>Welecome to the <code>Docker</code> series and I&rsquo;m gonna study this book, <code>Learn Docker in a Month of Lunches</code>(2020), by own my word.</p>
<p>This series consists of 4 parts:</p>
<ol>
<li>Understaning Docker Containers &amp; Images</li>
<li>Running Distributed Applications in Containers</li>
<li>Running at Scale with a Container Orchestrator</li>
<li>Getting Your Containers Ready for Production</li>
</ol>
<p>This is the first post about series <code>Docker</code>.
In this part, you can get up to speed quickly on the core Docker concepts: containers, images, and registries. you&rsquo;ll learn how to run applications in containers, package your own applications in containers, and share those applications for other people to use. You&rsquo;ll also learn about storing data in Docker volumes and how you can run stateful apps in containers. After throughing this chapter, you&rsquo;ll be comfortable with all the fundamentals of Docker, and you&rsquo;ll be learning with best pracices baked in from the start.</p></div>
            <div class="other-date">2024-3-28</div>
        </div>
    </div>
</a>
            </a>
        
            <a href="http://jaym-oh.github.io/posts/markdown/extendedmd/">
                
<a href="http://jaym-oh.github.io/posts/markdown/extendedmd/">
    <div class="list-item">
        <div class="icon-other-root">
            
                <div class="icon-other" style="background-image: url( /images/default.jpg );"></div>
            
        </div>
        <div class="list-right">
            <div class="other-title">
                How to use Extended Markdown
            </div>
            <div class="other-summary">Code Code in line Example: basic: &ldquo;name&rdquo; options: you can add options featuring as what you want to highlight just add (primary), (tip), (warning), (success), (danger) with one white space name (primary) name (tip) name (warning) name (success) name (danger) Example of code block 1 2 3 4 5 6</div>
            <div class="other-date">2024-2-12</div>
        </div>
    </div>
</a>
            </a>
        
    </div>
</div>
        </div>
        <div id="r2">
            <div id="vcomments"></div>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script type="text/javascript">
    new Valine({
        el: '#vcomments',
        appId: "1bY2Xk28MG2rZwn5yhAgSf7J-MdYXbMMI",
        appKey: "0PMhHHKR1uBcp1aw5bXHvge7",
        avatar: "robohash",
        placeholder: "댓글을 입력하세요",
        requiredFields: ["nick"],
        visitor:  true ,
        pageSize:  10 ,
        recordIP:  null ,
        lang: 'en'
});
</script>

        </div> 
    </div>
</div>

            </div>
        </div>
    </div>
</div>

    

<div class="sponsor">
    <div class="sponsor-self">
        <div class="sponsor-title">Sponsor</div>
        <div class="sponsor-btn">
            
                
                    
                        <div class="sponsor-btn-1 border-r">Wechat</div>
                    
                
                
            
                
                    
                        <div class="sponsor-btn-2 border-l">Alipay</div>
                    
                
                
            
        </div>
        
        <div class="sponsor-img">
            
                
                    <img class="sponsor-img-1" src="/images/sponsor/wechat.jpeg" alt="">
                
                
            
                
                    <img class="sponsor-img-2" src="/images/sponsor/alipay.jpeg" alt="" style="display: none;">
                
                
            
        </div>
        <div class="cancel efct-button">cancel</div>
    </div>
</div>


        </div>

        <footer class="footer">
    
        <div class="container">
            <div class="footer-items">
                
                    <div class="footer-item">
                        <i class="fa fa-user"></i> <span id="busuanzi_value_site_pv"></span> |
                        <i class="fa fa-eye"></i> <span id="busuanzi_value_site_uv"></span>
                    </div>
                
                
                    <div class="footer-item">
                        © 2022-2024 <a href="https://github.com/JayM-Oh">JAY OH</a>
                    </div>
                
                
            </div>
        </div>
    

    
</footer>


        
        <div class="search-root">
    <div class="search-zz"></div>
    <div class="search">
        <div class="sheader anniu">
            <div class="sh-l">
                <input type="text" placeholder='Enter a KeyWord' id="search-key">
                <span class="sclear"><i class="fa fa-close"></i></span>
            </div>
            <div class="sh-r">
                <button>search</button>
            </div>
        </div>
        <div class="sbody">
            <div class="sbody-1">
                <div class="stip"></div>
            </div>
        </div>
    </div>
</div>
        









    
    

    
    

    
    

    
    

    
    




<script type="text/javascript">
    var mode_custom = "auto";
    var postsCount =  5 ;
    var arrPosts = [{"link":"http://jaym-oh.github.io/posts/algorithm/sorting/sorting_2/","plain":"Problem Jay likes sequences, so he use to playing with a sequence of size N. He will transform the sequence according to K queries, and the format and process of the queries are as follows:\nL R X: Let\u0026rsquo;s say the sequence sorted in ascending order is A[1], A[2], …, A[N]. First, add X to A[L], A[L+1], …, A[R]. Then, sort the sequence again in ascending order. Print the sequence after performing all the queries in order.\nInput tip The first line is given with N and K separated by a space. (1 ≤ N ≤ 100000, 1 ≤ K ≤ 1000)\nThe second line is given with N integers that make up the sequence, each having an absolute value of less than or equal to 10^18.\nFrom the third line to the (K+2)th line, the queries L R X are given. (1 ≤ L ≤ R ≤ N, |X| ≤ 10^9)\nOutput tip Print the sequence after performing all the queries in order.\nExample: (tip)\n\\(Input: 7 3 1 2 3 4 5 6 7 1 6 3 2 7 -4 4 5 6 Output: 1 2 3 4 5 9 10\\) How to Approach? Though there is no single correct solution, there are effective ones. I usally take follow steps:\nwe need a input function validation function to prove user input proper or not print function to print out our output do function (This can be further divided into several actions) (if we need)calculate function step1. Input function First we need input function. In java, there exist some other input method but I usually use this method:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.util.StringTokenizer; public static void getUserInput(ArrayList\u0026lt;Long\u0026gt; sequence, int[] nk) throws IOException { BufferedReader br = new BufferedReader(new InputStreamReader(System.in)); StringTokenizer st = new StringTokenizer(br.readLine()); nk[0] = Integer.parseInt(st.nextToken()); // N nk[1] = Integer.parseInt(st.nextToken()); // K st = new StringTokenizer(br.readLine()); // Tokenizing the sequence line while (st.hasMoreTokens()) { sequence.add(Long.parseLong(st.nextToken())); } } By using BufferedReader, you can quickly get input values.\nstep2. validation function 1 2 3 4 5 6 7 8 9 10 11 n, k = map(int, input().split()) sequence = list(map(int, input().split())) while(k \u0026gt; 0): l, r, x = map(int, input().split()) for i in range(l, r+1): sequence[i] += x sequence.sort() k -= 1 print(*sequence) ","pubDate":"2024-03-29","title":"Sorting Problem"},{"link":"http://jaym-oh.github.io/posts/algorithm/sorting/sorting_1/","plain":"Introduction What this post focus on This posting will cover almost every concept of How to sort (primary). Plus, I\u0026rsquo;ll post realistic algorithm problem of our real world so that you can apply those concept to real world problem and learn how to use it. I really hope so. Let\u0026rsquo;s see the below example.\n","pubDate":"2024-03-29","title":"How to Sort Data"},{"link":"http://jaym-oh.github.io/posts/database/db_15_2/","plain":"ENUM 테이블의 구조에 나열된 목록 중 하나의 값을 가질 수 있다. 1 2 3 4 5 6 create table tb_enum ( fd_enum enum(\u0026#39;PROCESSING\u0026#39;, \u0026#39;FAILURE\u0026#39;, \u0026#39;SUCCESS\u0026#39;) ); -- 매핑된 문자열이 아닌 내부적으로 저장된 숫자 값으로 연산이 실행됨 select fd_enum*1 as fd_enum_real_value from tb_enum; enum 타입은 쿼리에서 char, varchar 타입과 같은 문자열로 비교하거나 저장할 수 있다. enum 타입에 사용할 수 있는 최대 아이템 갯수는 65535개 아이템 갯수가 255개 미만이면 1바이트를 사용 장점 테이블 구조에 정의된 코드 값만 사용할 수 있게 강제한다. DB 서버의 디스크 저장 공간의 크기를 줄여줌 레코드가 많아질수록 효율적 단점 enum 타입에 새로운 값을 추가한다면 테이블의 구조를 변경해야 한다.\nMySQL 5.6 이전까지는 항상 테이블을 리빌드해야 했음 -\u0026gt; 별로 사용하지 않음 MySQL 5.6 부터는 새로 추가하는 아이템이 enum 타입의 제일 마지막에 추가되는 형태하면 텡블의 구조 변경만으로 즉시 완료된다. 1 2 3 4 5 6 7 alter table tb_enum modify fd_enum enum(\u0026#39;PROCESSING\u0026#39;, \u0026#39;FAILURE\u0026#39;, \u0026#39;SUCCESS\u0026#39;, \u0026#39;REFUND\u0026#39;), algorithm=instant; alter table tb_enum modify fd_enum enum(\u0026#39;PROCESSING\u0026#39;, \u0026#39;FAILURE\u0026#39;, \u0026#39;REFUND\u0026#39;, \u0026#39;SUCCESS\u0026#39;), algorithm=copy, lock=shared; 테이블이 매우 크다면 가독성이 조금 떨어지더라도 새로운 아이템을 enum 마지막에 추가하는 것이 MySQL 서버의 가용성을 높이는 방법 enum 타입 값으로 정렬하면 매핑된 코드 값으로 정렬이 수행됨 enum은 문자열이 아닌 정수 타입의 컬럼 되도록이면 enum 기준으로 정렬은 안하는게 좋음 SET enum과의 차이: set은 하나의 컬럼에 1개 이상의 값을 저장할 수 있다. MySQL 서버는 내부적으로 BIT-OR 연산을 거쳐서 1개 이상의 선택된 값을 저장한다. 여러 개의 값을 저장할 수 있지만 그만큼의 공간을 가지지는 않음 아이템 수가 8개 이하면 1바이트의 저장공간을 가짐 1 2 3 4 5 6 7 8 9 create table tb_set ( fd_set set(\u0026#39;TENNIS\u0026#39;, \u0026#39;SOCCER\u0026#39;, \u0026#39;GOLF\u0026#39;, \u0026#39;TABLE-TENNIS\u0026#39;, \u0026#39;BASKETBALL\u0026#39;, \u0026#39;BILLIARD\u0026#39;) ); insert into tb_set (fd_set) values (\u0026#39;SOCCER\u0026#39;), (\u0026#39;GOLF,TENNIS\u0026#39;); select * from tb_set where find_in_set(\u0026#39;GOLF\u0026#39;, fd_set); select * from tb_set where fd_set=\u0026#39;GOLF,TENNIS\u0026#39;; find_in_set 함수나 like로 검색할 수 있음 find_in_set 함수는 해당 컬럼에 인덱스가 있어도 효율적으로 인덱스를 이용할 수 없다. 이런 형태의 검색이 빈번히 사용된다면 set 타입의 컬럼을 정규화해서 별도로 인덱스를 가진 자식 테이블을 생성하는 것이 좋다. equals 비교 시에는 컬럼에 저장된 순서대로 문자열을 나열해야 검색 가능 중간에 아이템이 추가된다면 테이블의 읽기 잠금과 리빌드 작업이 필요 1 2 3 alter table tb_set modify fd_set set(\u0026#39;TENNIS\u0026#39;, \u0026#39;SOCCER\u0026#39;, \u0026#39;GOLF\u0026#39;, \u0026#39;TABLE-TENNIS\u0026#39;, \u0026#39;Football\u0026#39;, \u0026#39;BASKETBALL\u0026#39;, \u0026#39;BILLIARD\u0026#39;), algorithm=copy, lock=shared; 아이템 갯수가 8 -\u0026gt; 9개로 변경될 때는 set 타입을 저장하기 위한 공간을 2바이트로 변경해야하기 때문에 읽기 잠금과 테이블 리빌드 작업이 필요하다. TEXT와 BLOB 데이터 타입 필요 저장 공간 (L = 저장하고자 하는 데이터의 바이트 수) 저장 가능한 최대 바이트 수 TINYTEXT, TINYBLOB L + 1바이트 $2^8-1(255)$ TEXT, BLOB L + 2바이트 $2^{16} - 1(65535)$ MEDIUMTEXT, MEDIUMBLOB L + 3바이트 $2^{24}-1(16777215)$ LONGTEXT, LONGBLOB L + 4바이트 $2^{32}-1(4294967295)$ 고정길이 가변길이 대용량 문자 데이터 CHAR VARCHAR TEXT 이진 데이터 BINARY VARBINARY BLOB TEXT, BLOB 타입 모두 주의하고 남용하면 안됨 컬럼 하나에 저장되는 문자열이나 이진 값의 길이가 예측할 수 없이 클 때 일반적으로 하나의 레코드는 전체 크기가 64KB를 넘을 수 없지만 이를 초과할 때 blob/text 컬럼을 조작하는 sql문의 길이가 많이 길어질 수 있음 max_allowed_packet 시스템 변수에 설정된 값보다 큰 sql 문장은 MySQL 서버로 전송되지 못하고 오류가 발생할 수 있음 max_allowed_packet 값을 충분히 늘리도록 설정 MySQL 서버에서 text, blob 컬럼의 값이 어떻게 저장되는지는 테이블의 row_format 옵션을 사용한다. 별도로 지정되지 않으면 innodb_default_for_format 시스템 변수에 저장된 값으로 적용한다. MySQL 8.0에서는 사용 가능한 모든 row_format에서는 가능하다면 text/blob 컬럼의 값을 다른 레코드와 같이 저장하려고 하지만 레코드의 최대 길이가 제한적인 문제가 있음 레코드의 최대 길이를 초과하면 용량이 큰 컬럼 순서대로 외부 페이지로 옮기면서 레코드의 크기를 맞춘다. 공간 데이터 타입 MySQL 서버는 OpenGIS에서 제시하는 표준을 준수함 WKT (Well Known Text) or WKB (Well Known Binary)를 이용해서 공간 데이터를 관리할 수 있게 지원 MySQL에서 제공하는 공간 정보 저장용 데이터 타입: POINT, LINESTRING, POLYGON, GEOMETRY, GEOMETRYCOLLECTION 등 geometry로 하나의 점/선/다각형을 저장하거나 geometrycollection으로 여러개의 데이터를 저장할 수 있음 공간 데이터 생성 MySQL 서버에서 공간 데이터를 생성할 때는 WKT 포맷을 이진 데이터 포맷의 데이터로 변환할 수 있음 WKT 포맷: POINT(x y) 객체 생성: ST_PointFromText(\u0026lsquo;POINT(x y)\u0026rsquo;) FromText 대신 FromWKB를 사용하면 WKB를 이용한 공간 데이터 객체를 생성한다. 두번째 파라미터로 SRID를 설정 가능 1 2 3 4 5 ST_PointFromText(\u0026#39;POINT(10,20)\u0026#39;) ST_PointFromText(\u0026#39;POINT(37.123123, 127.233243)\u0026#39;) ST_PointFromText(\u0026#39;POINT(10,20)\u0026#39;, 0) ST_PointFromText(\u0026#39;POINT(37.123123, 127.233243)\u0026#39;, 4326) SRID를 명시하지 않으면 SRID=0인 객체를 생성한다. 공간 데이터 조회 MySQL 서버가 관리하는 공간 데이터를 조회하는 방법 이진 데이털 조회 (WKB 포맷 or MySQL 이진 포맷) 텍스트 데이터 조회 (WKT 포맷) 공간 데이터의 속성 함수를 이용한 조회 1, 2번째는 공간 데이터 타입과 관계없이 ST_AsText() / ST_AsWKT() or ST_AsBinary() / ST_AsWKB() 함수로 조회 가능 1 2 3 4 5 6 7 8 9 10 set @poi:=ST_PointFromText(\u0026#39;POINT(37.123123 127.123123)\u0026#39;, 4326) select ST_SRID(@poi) as srid, ST_X(@poi) as coord_x, ST_Y(@poi) as coord_y, ST_Latitude(@poi) as coord_latitude, ST_Longitude(@poi) as coord_longitude; -- ST_Latitude ST_Longitude는 위도/경도를 사용하는 좌표시스템의 공간 데이터에서만 사용 가능 JSON 타입 MySQL 5.7 부터 JSON 데이터를 저장할 수 있는 JSON 타입이 지원되기 시작 MySQL 8.0 부터 많은 기능과 성능이 개선됨 MySQL 서버에서 TEXT, BLOB 컬럼에 JSON 데이터를 저장할 수는 있음 MySQL 5.7부터 지원되는 JSON 데이터 컬럼은 문자열 저장이 아닌 MongoDB와 같이 바이너리 포맷의 BSON(Binary JSON)으로 변환해서 저장한다. 저장 방식 BSON 타입으로 변환해서 저장하기 때문에 TEXT/BLOB보다 공간 효율이 높은 편 1 2 3 4 5 6 7 8 9 10 create table tb_json (id int, fd json); insert into tb_json values (1, \u0026#39;{\u0026#34;user_id\u0026#34;: 123}\u0026#39;), (2, \u0026#39;{\u0026#34;user_id\u0026#34;: \u0026#34;123\u0026#34;}\u0026#39;); select id, fd, json_type(fd -\u0026gt; \u0026#34;$.user_id\u0026#34;) as field_type, json_storage_size(fd) as byte_size tb_json; json document가 MySQL 서버의 JSON 컬럼에 저장되면 이진 데이터로 변환하여 저장한다. 용량이 매우 큰 document가 저장되면 MySQL 서버는 16KB 단위로 여러 개의 데이터 페이지로 나뉘어 저장한더. MySQL 5.7 까지는 BLOB 페이지들이 단순 연결 리스트처럼 관리되었음 MySQL 8.0 부터는 BLOB 페이지들의 인덱스를 관리하고, 각 인덱스는 실제 BLOB 데이터를 가진 페이지들의 링크를 갖도록 개선함 부분 업데이트 성능 MySQL 8.0 부터 JSON 타입에 대해 부분 업데이트 기능 제공 JSON_SET() JSON_REPLACE() JSON_REMOVE() 함수를 이용해서 JSON document의 특정 필드 값을 변경하거나 삭제하는 경우에만 작동 1 2 3 4 5 6 update tb_json set fd=json_set(fd, \u0026#39;$.user_id\u0026#39;, \u0026#34;12345\u0026#34;) where id=2; select id, fd, json_storage_size(fd), json_storage_free(id) from tb_json; id fd json_storage_size(fd) json_storage_free(fd) 1 {\u0026ldquo;user_id\u0026rdquo;, 1234567890} 23 0 2 {\u0026ldquo;user_id\u0026rdquo;, \u0026ldquo;12345\u0026rdquo;} 30 5 위 변경 작업이 부분 업데이트로 처리되었는지는 확인할 수 없음 json_storage_size, json_storage_free 함수로 대략 예측 두번째 레코드는 json_storage_free가 5로 표시됨 \u0026ldquo;12345\u0026quot;로 변경되면서 앞 부분의 5바이트 사용, 5바이트는 비움 해당 필드의 값을 10바이트보다 큰 값으로 저장할 경우 json_set() 함수를 사용해도 부분 업데이트 진행 x 최초 할당된 공간이 부족해서 MySQL 서버가 JSON 컬럼 or 두번째 레코드를 다른 위치로 복사해서 저장 MySQL 내부적으로 json 컬럼의 값은 BLOB 타입으로 저장되는데 실제 json 컬럼의 값은 4GB까지 값을 가질 수 있음 1MB json 데이터를 저장해도 MySQL 서버는 16KB * 64개 페이지를 사용함 부분 업데이트를 한다면 1개의 페이지만 변경하면 되고, 안되면 모든 페이지를 다시 디스크로 기록해야함 단순 정수필드의 값을 변경하는 작업은 항상 부분 업데이트 기능이 적용 문자열 타입의 필드라면 문자열의 길이에 따라 부분 업데이트가 되지 않을수도 있음 자주 길이가 변한다면 해당 필드가 가질 수 있는 최대 길이로 초기화하거나 애플리케이션에서 추가로 패딩해서 고정 길이의 문자열로 만들어서 저장하는 방법이 있음 JSON 타입 콜레이션과 비교 json 컬럼에 저장되는 데이터와 이를 가공해서 나온 결과는 모두 utf8mb4 문자 집합과 utf8mb4_bin 콜레이션을 가진다. utf8mb4_bin 콜레이션은 바이너리 콜레이션이므로 json을 가공해서 나온 문자열은 대소문자나 액센트 문자도 구분해서 비교한다. JSON 컬럼 선택 TEXT/BLOB vs JSON TEXT/BLOB에 json 문자열을 저장하는 경우 아무런 변환과정을 거치지 않고 값을 디스크에 저장한다. JSON 타입은 json 데이터를 이진 포맷으로 컴팩션해서 저장하고, 필요한경우 부분 업데이트를 통한 빠른 변경 기능을 제공한다. A무조건 json 타입 사용이 좋음 정규화한 컬럼 vs json 컬럼 json 컬럼만 유지하는 경우에도 필요한 인덱스를 모두 생성할 수 있음 MySQL 8.0부터 멀티 밸류 인덱스 기능이 지원되기 때문에 json document에서 array 타입의 필드에도 인덱스를 생성할 수 있게됨 성능을 중심으로 판단한다면 정규화된 컬럼을 추천 테이블을 너무 정규화했을때 테이블 갯수가 많아지더간 응용 프로그램의 코드도 길어질 수 있음 중요도가 낮다면 json 컬럼 사용도 가능 가상 컬럼 (파생 컬럼) MySQL 서버의 가상 컬럼은 가상 컬럼/스토어드 컬럼으로 구분 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 -- 가상 컬럼 create table tb_virual_column ( id int not null auto_increment, price decimal(10,2) not null default \u0026#39;0.00\u0026#39;, quantity int not null default 1, total_price decimal(10,2) as (quantity * price) virtual, primary key (id) ); -- 스토어드 컬럼 create table tb_stored_column ( id int not null auto_increment, price decimal(10,2) not null default \u0026#39;0.00\u0026#39;, quantity int not null default 1, total_price decimal(10,2) as (quantity * price) stored, primary key (id) ); 컬럼의 정의 뒤에 as절로 계산식을 정의한다. 마지막에 stored 키워드가 사용되면 스토어드 컬럼으로 생성되며, 그 외에는 가상 컬럼으로 생성된다. (default는 virtual) 가상 컬럼의 표현식은 입력이 동일하면 시점과 관계없이 결과가 항상 동일한 표현식만 사용할 수 있음 사용자 변수나 not-deterministic 옵션의 함수나 표현식 사용할 수 없음 MySQL 8.0 까지는 가상 컬럼의 표현식에 서브쿼리나 스토어드 프로그램을 사용할 수 없음 가상/스토어드 컬럼 모두 다른 컬럼의 값을 참조해서 새로운 값을 만들어 관리한다는 공통점이 있음 단점 가상 컬럼 컬럼의 값이 디스크에 저장되지 않음 컬럼의 구조 변경은 테이블 리빌드를 필요로 하지 않음 컬럼의 값은 레코드가 읽히기 전 또는 before 트리거 실행 직후에 계산되어 만들어짐 스토어드 컬럼 컬럼의 값이 물리적으로 디스크에 저장됨 컬럼의 구조 변경은 다른 일반 테이블과 같이 필요 시 테이블 리빌드 방식으로 처리됨 insert, update 시점에만 컬럼의 값이 계산됨 차이 계산된 컬럼의 값이 디스크에 실제 저장되는지 여부 가상 컬럼은 디스크에 저장되지 않지만 항상 그런건 아님 가상 컬럼은 데이터를 조회하는 시점에 매번 계산되기 때문에 가상 컬럼의 값을 계산하는 과정이 복잡하고 시간이 오래걸린다면 스토어드 컬럼으로 변경하는 것이 성능 향상에 좋음 ","pubDate":"2024-03-29","title":"Data Type in DB"},{"link":"http://jaym-oh.github.io/posts/docker/docker_1/","plain":"Welecome to the Docker series and I\u0026rsquo;m gonna study this book, Learn Docker in a Month of Lunches(2020), by own my word.\nThis series consists of 4 parts:\nUnderstaning Docker Containers \u0026amp; Images Running Distributed Applications in Containers Running at Scale with a Container Orchestrator Getting Your Containers Ready for Production This is the first post about series Docker. In this part, you can get up to speed quickly on the core Docker concepts: containers, images, and registries. you\u0026rsquo;ll learn how to run applications in containers, package your own applications in containers, and share those applications for other people to use. You\u0026rsquo;ll also learn about storing data in Docker volumes and how you can run stateful apps in containers. After throughing this chapter, you\u0026rsquo;ll be comfortable with all the fundamentals of Docker, and you\u0026rsquo;ll be learning with best pracices baked in from the start.\nWhat is Docker Docker is a platform for running application in lightweight units called containers. Containers have taken hold in software everywhere, from werverless functions in the cloud to strategic planning in the enterprise. Docker is becoming a core com- petency for operators and developers across the industry—in the 2019 Stack Overflow survey, Docker polled as people’s number one “most wanted” technology And Docker is a simple technology to learn. You can pick up this book as a com- plete beginner, and you’ll be running containers in chapter 2 and packaging appli- cations to run in Docker in chapter 3. Each chapter focuses on practical tasks, with examples and labs that work on any machine that runs Docker—Windows, Mac, and Linux users are all welcome here. The journey you’ll follow in this book has been honed over the many years I’ve been teaching Docker. Every chapter is hands-on—except this one. Before you start learning Docker, it’s important to understand just how containers are being used in the real world and the type of problems they solve—that’s what I’ll cover here. This chapter also describes how I’ll be teaching Docker, so you can figure out if this is the right book for you. Now let’s look at what people are doing with containers—I’ll cover the five main scenarios where organizations are seeing huge success with Docker. You’ll see the wide range of problems you can solve with containers, some of which will certainly map to scenarios in your own work. By the end of this chapter you’ll understand why Docker is a technology you need to know, and you’ll see how this book will get you there.\nWhy containers will take over the world Creating lab envionment how to install docker in your operaing system? docker run in your computer as flows:\n내 블로그가 왜 음란해 이 미친 ㄱㅇ찰푸덮 아러ㅗㄷㅇ라ㅜ ㅇ러푸대 루 Being immediately effective “Immediately effective” is another principle of the Month of Lunches series. In all the chapters that follow, the focus is on learning skills and putting them into practice. Every chapter starts with a short introduction to the topic, followed by try-it-now exercises where you put the ideas into practice using Docker. Then there’s a recap with some more detail that fills in some of the questions you may have from diving in. Lastly there’s a hands-on lab for you to go the next stage. All the topics center around tasks that are genuinely useful in the real world. You’ll learn how to be immediately effective with the topic during the chapter, and you’ll fin- ish by understanding how to apply the new skill. Let’s start running some containers!\ncontinue\u0026hellip;\n","pubDate":"2024-03-28","title":"Before you begin"},{"link":"http://jaym-oh.github.io/posts/markdown/extendedmd/","plain":"Code Code in line Example: basic: \u0026ldquo;name\u0026rdquo;\noptions: you can add options featuring as what you want to highlight just add (primary), (tip), (warning), (success), (danger) with one white space\nname (primary)\nname (tip)\nname (warning)\nname (success)\nname (danger)\nExample of code block 1 2 3 4 5 6 7 8 9 10 close #클릭하면 열립니다 import sys input = sys.stdin.readline def getUserInput(): n = input() print(f\u0026#39;user input is : {n}\u0026#39;) if __name__ == \u0026#39;__main__\u0026#39;: getUserInput() If you add \u0026lsquo;close\u0026rsquo; option into the first line of the code block, you can roll up the code block\n3개부터는 애니메이션 효과가 사라집니다. 대신 볼드체로 강조됩니다. 또한 개수가 증가할 수록 글자의 크기가 작아집니다. As you can see, more than 2 #, it just be bolder and smaller\n🥳 이모지 테스트 😤 이모지 테스트\nwith \u0026amp; without count 순서를 세고 싶을 땐 넘버링을 하고 이런 식으로 세지 않을 수도 있습니다. quotation 이것은 인용 예시입니다.\n두 line을 개행하여 단락 구분을 할 수도 있고 두 space를 띄워 단락 내 개행을 할 수도 있습니다.\n기본 인용은 회색으로 표시되며 두 칸을 띄워야 개행이 됩니다.\n마찬가지로 옵셥을 추가할 수 있습니다.\nprimary \u0026lsquo;primary\u0026rsquo; 예약어를 사용한 경우입니다.\n주요 문단입니다\ntip \u0026rsquo;tip\u0026rsquo; 예약어를 사용한 경우입니다.\n팁 문단입니다\nwarning \u0026lsquo;warning\u0026rsquo; 예약어를 사용한 경우입니다.\n경고 문단입니다\nsuccess \u0026lsquo;success\u0026rsquo; 예약어를 사용한 경우입니다.\n성공 문단입니다\ndanger \u0026lsquo;danger\u0026rsquo; 예약어를 사용한 경우입니다.\n실패(위험) 문단입니다\nPicture Basically, picture has a shadow. so if you don\u0026rsquo;t want to add it, just add _no at the end of the text in quotation\ntitle with shadow\n1 ![photo](/images/example.jpeg \u0026#39;제목을 지어주세요\u0026#39;) result: title without shadow\n1 ![photo](/images/example.jpeg \u0026#39;제목을 지어주세요_no\u0026#39;) result: without title but shadow\n1 ![photo](/images/example.jpeg) result: without title and shadow\n1 ![photo](/images/example.jpeg \u0026#39;_no\u0026#39;) result: Tap ::: tabs와 :::을 탭 컨테이너의 시작과 끝으로 사용하며, @tab을 사용하여 다양한 탭을 표시하고 구분합니다.\n@tab 다음은 제목이며, 기본적으로 첫 번째 탭이 활성화됩니다.\n또한, @tab 다음에 텍스트 :active를 추가하여 해당 탭을 기본적으로 활성화할 수 있습니다.\nexample of tap basic use\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs \u0026lt;!-- \u0026#39;:::\u0026#39;와 \u0026#39;tabs\u0026#39; 사이에는 반드시 하나의 공백이 있어야 합니다 --\u0026gt; \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab jay\u0026lt;!-- \u0026#39;@tab\u0026#39;과 제목 사이에는 반드시 하나의 공백이 있어야 합니다 --\u0026gt; \u0026lt;!-- 필수 공백 줄 --\u0026gt; Hi I\u0026#39;m jay! \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab lay \u0026lt;!-- 필수 공백 줄 --\u0026gt; I\u0026#39;m lay! \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab kelvin \u0026lt;!-- 필수 공백 줄 --\u0026gt; yeah I\u0026#39;m kelvin! \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs\n@tab jay\nHi I\u0026rsquo;m jay!\n@tab lay\nI\u0026rsquo;m lay!\n@tab kelvin\nyeah I\u0026rsquo;m kelvin!\n:::\noption :active\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab jay \u0026lt;!-- 필수 공백 줄 --\u0026gt; Hi I\u0026#39;m jay! \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab:active lay \u0026lt;!-- 필수 공백 줄 --\u0026gt; I\u0026#39;m lay! \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab kelvin \u0026lt;!-- 필수 공백 줄 --\u0026gt; yeah I\u0026#39;m kelvin! \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs\n@tab jay\nHi I\u0026rsquo;m jay!\n@tab:active lay\nI\u0026rsquo;m lay!\n@tab kelvin\nyeah I\u0026rsquo;m kelvin!\n:::\noption #id\nyou can add \u0026lsquo;id\u0026rsquo; into the tap container and if two containers have same \u0026lsquo;id\u0026rsquo;, they share tap switching event.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs#install \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab npm \u0026lt;!-- 필수 공백 줄 --\u0026gt; npm을 사용하여 xxx설치 \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab Homebrew \u0026lt;!-- 필수 공백 줄 --\u0026gt; Homebrew를 사용하여 xxx설치 \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab MacPorts \u0026lt;!-- 필수 공백 줄 --\u0026gt; MacPorts를 사용하여 xxx설치 \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: \u0026lt;!-- 필수 공백 줄 --\u0026gt; 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs#install \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab npm \u0026lt;!-- 필수 공백 줄 --\u0026gt; npm을 사용하여 yyy설치 \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab Homebrew \u0026lt;!-- 필수 공백 줄 --\u0026gt; Homebrew를 사용하여 yyy설치 \u0026lt;!-- 필수 공백 줄 --\u0026gt; @tab MacPorts \u0026lt;!-- 필수 공백 줄 --\u0026gt; MacPorts를 사용하여 yyy설치 \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: \u0026lt;!-- 필수 공백 줄 --\u0026gt; ::: tabs#install\n@tab npm\nnpm을 사용하여 xxx설치\n@tab Homebrew\nHomebrew를 사용하여 xxx설치\n@tab MacPorts\nMacPorts를 사용하여 xxx설치\n:::\n::: tabs#install\n@tab npm\nnpm을 사용하여 yyy설치\n@tab Homebrew\nHomebrew를 사용하여 yyy설치\n@tab MacPorts\nMacPorts를 사용하여 yyy설치\n:::\nmermaid you can draw graph and flow chart with mermaid.\n1 2 3 4 ```mermaid flowchart LR A -- text --\u0026gt; B -- text2 --\u0026gt; C ``` flowchart LR A -- text --\u0026gt; B -- text2 --\u0026gt; C more usage in here: https://mermaid.js.org/#/\nmath math in line 1 2 3 4 ```math \u0026#34;\u0026lt;!-- \u0026#39;\\(\u0026#39; 와 \u0026#39;\\)\u0026#39; 로 인라인 수식의 시작과 끝을 표시 --\u0026gt;\u0026#34; 행내 공식입니다：\\( x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a} \\) ``` 행내 공식입니다：\\( x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a} \\) math in block 1 2 3 4 ```math \u0026#34;\u0026lt;!-- \u0026#39;$$\u0026#39; 와 \u0026#39;$$\u0026#39; 로 수식 블록의 시작과 끝을 표시 --\u0026gt;\u0026#34; 블럭 내 공식입니다：$$ x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a} $$ ``` 블럭 내 공식입니다：$$ x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a} $$ more usage in here: mathjax: https://www.mathjax.org\n","pubDate":"2024-02-12","title":"How to use Extended Markdown"}];
    var search_theEnd = "The End";
    var search_nothing = "Nothing was found";
    var search_found = "Found";
    var search_result = "result";
    var search_results = "results";
    var enable_mermaid =  false ;

    var baseURL = "http://jaym-oh.github.io/";
</script>





        
    </body>
</html>

